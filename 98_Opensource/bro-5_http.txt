오늘 살펴볼 로그 파일은 HTTP.log이다. HTTP(Hyper Text Transfer Protocol)의 약자로 WWW에서 주로 사용한다. 
워낙 대중적인 프로토콜이라서 최근 인터넷 통신은 HTTP가 여러 임무를 맡고 있다. 인터넷 초창기만 해도 파일 전송은 FTP(File Transfer Protocol)이었다.
하지만 이제 인터넷에서 FTP로 파일을 주고 받는 경우는 거의 없다. 대부분 HTTP를 이용한 웹 서버서에서 다운로드가 이루어진다.
WWW에서 지원하기 때문에 웹 브라우저에서 사용하는 주소의 가장 처음이 http://로 시작한다. 이 의미는 뒤에 나오는 주소를 HTTP로 접속하겠다는 의미이다.
사용자들이 가장 많이 사용하기 때문에 공격자 역시 가장 많이 사용하는 프로토콜이 되었다. 
Bro가 생성하는 http로그는 HTTP 프로토콜 헤더에서 정보를 추출한다. HTTP의 헤더는 대단히 복잡하고 사용하지 않은 헤더도 상당하다.
그러므로 Bro의 기본 설정만으로도 HTTP 현황을 충분히 파악할 수 있다. 예제 패킷에서 추출한 http.log의 필드명을 살펴보자.   
핵심 필드 중심으로 내용을 살펴볼 것이며 모든 필드를 살펴보지는 않는다. 

이제 다음 6개 필드에 대해서는 익숙할 것이다. 
ts(time)
uid(string)
id.orig_h(addr), id.orig_p(port), id.resp_h(addr), id.resp_p(port)

method(string)
클라이언트가 요청한 HTTP 메소드이다. GET, POST 등이 여기에 해당된다. 

host(string)
HTTP 서비스를 제공하는 서버이다. 즉, 웹 서버의 호스트명으로 도메인 이름이 로그에 저장된다. 

uri(string)
사용자가 요청한 자원의 상세 주소이다. 호스트 필드값과 uri를 결합하면 전체 웹 주소가 나온다.

referrer(string)
사용자가 접속하는 URI가 어디에서 출발했는지를 보여주는 값이다. referrer가 있다는 것은 다른 사이트를 경유해서 uri에 접속함을 의미한다. 

user_agent(string)
사용자가 웹 서버에 접속하는데 사용한 HTTP 클라이언트이다. 대부분 웹브라우저 이름이다. 
http://www.user-agents.org/에서 사용자 에이전트 종류를 찾아볼 수 있다.

request_body_len(count)
클라이언트가 요청한 내역의 용량으로 바이트 수이다.  외부로 파일을 전송하는 것도 클라이언트가 요청하는 것이다. 
보안목적에서 http.log를 사용한다면 이 필드는 외부 데이터 유출을 파악할 때 사용할 수 있다. 

response_body_len(count)
서버가 클라이언트에게 전송한 용량으로 역시 바이트 수이다. 클라이언트가 다운로드를 받으면 이 수치가 증가한다. 

status_code(count)
웹서버가 제공하는 상태코드로서 클라이언트의 요청에 대한 서버의 응답이다. 세자리 숫자이며 200, 300, 400, 500계열이 있다.

status_msg(string)
상태코드가 의미하는 내용을 문자열로 보여주는 것이다. 200은 정상이므로 OK로 나타난다. 상태코드의 의미를 알고 있는 사용자에게는 큰 의미가 없다.

보안담당자라면 HTTP 로그를 잘 숙지해야 한다. 사용자의 행위 분석을 위해서 http.log는 풍부한 정보를 제공한다. 향후 Splunk에서 SIEM을 만들때 자세히 설명할 계획이다.
 다음에는 파일 전송 프로토콜인 FTP를 알아보자. 