오랫만에 블로그 글을 올려본다. SIEM의 구성에 대해서 계속 살펴보자. 

앞의 글에서 SIEM의 구성에 대한 그림을 다음과 같이 살펴보았다. 
이 그림에서 데이터 통합 계층은 선택사항이다. 소규모인 경우 수집 데이터를 색인시스템에 직접 저장할 수 있다. 
데이터를 색인시스템에 저장하려면 데이터 수집을 먼저 실시해야 한다. 이것은 수집 원본소스가 제공하는 기능에 종속적이다. 
유닉스, 리눅스 시스템은 기본적으로 syslog를 운영할 수 있다. 그러므로 로그를 외부로 전송하는 것이 유리하다. 
반면 윈도우 계열의 운영체제는 syslog를 지원하지 않으므로 별도의 응용 프로그램을 설치해야 한다. 
대부분의 윈도우 계열 운영체제는 데이터 수집 전용 프로그램을 설치해서 색인시스템으로 로그를 전송하는 방식을 사용한다.

네트워크를 이용해서 직접 색인시스템으로 전송하는 방식과 전용 수집 프로그램을 이용해서 수집하는 방법은 각각의 장단점이 존재한다. 
우선 네트워크를 이용하는 방법의 장점으로는 전용 수집 프로그램의 설치가 필요없다는 점이다. 프로그램을 설치하지 않기 때문에 관리할 필요도 없다. 
그 결과 빠른 환경 설정이 가능하고 유지보수가 용이하다. 단점으로는 네트워크 접근통제의 영향을 받기 때문에 보안 정책을 변경해야 한다. 
네트워크가 불안정하면 전송과정에서 데이터가 유실될 가능성이 존재한다. 
전용 프로그램을 이용해서 데이터를 수집하는 방식의 장점은 로그 버퍼링이 가능하다는 장점이다. 
저장된 로그를 전용 프로그램이 가져가는 방식을 취하므로, 전용 프로그램의 장애가 발생해도 원본로그는 저장되어 있다는 점이다. 
그리고 운영대상 호스트가 네트워크에 연결되어 있으므로 별도의 방화벽 정책이 필요하지 않다는 점이다. 
단점으로는 전용프로그램의 관리가 어렵다는 점이다. 내부 사용자의 PC에 전용 프로그램을 설치해서 수집한다고 가정해보자. 
이렇게 되면 사용자의 수만큼 관리 대상이 신설된다는 의미이므로 자동화가 미비한 전산환경에서는 관리자의 업무 부담이 너무 가중된다. 
또한 전용 프로그램 자체가 공격대상이 될 수 있으며, 수집 프로그램이 손상되거나 오동작하는 경우를 고려해서 운영해야 한다는 점이다. 
어느 방식이나 장점과 단점이 존재하므로 보안관리자는 적절한 방식을 선택해야 한다. 
하지만 SIEM을 구축하려면 두 방식중에 하나를 선택하는 것이 아니라 두 방식을 모두 사용해야 하는 경우가 대부분이다. 
네트워크 장비인 라우터, 스위치 그리고 네트워크 보안장비의 대표격인 방화벽은 생성된 데이터를 네트워크로 전송하는 기능이 있다. 
반면 사용자의 PC는 윈도우 계열인 경우가 대부분이므로 사용자 계층의 정보를 수집하기 위해서 수집 전용 프로그램 역시 구동시켜야 하기 때문이다. 
SIEM을 설계하는 보안 담당자는 특정 방식을 고수할 것이 아니라 수집 대상이 지원하는 다양한 방식을 SIEM에서 어떻게 수용할 것인지를 고민해야 한다. 
그렇기 때문에 SIEM 자체가 다양한 수집 방식을 지원해야 하는 것은 당연한 것이다. 


수집 데이터 검색

보안 검색은 SIEM에서 이상징후를 탐지하거나 알려진 위협을 검색하는 방법이다. 
정보보안에서 가장 어려운 것이 탐지인 것을 감안하면 SIEM에서 탐지는 인공지능을 사용하는 것처럼 인지에 의한 탐지가 불가능하다. 
결국 SIEM 관리자가 탐지할 내역을 정해주고 이를 자동화시키는 방법을 사용한다.
보안 위협을 탐지하는 방법은 블랙리스트 탐지 방법, 화이트 리스트 탐지방법, 이상 징후 탐지 방법 등의 여러가지가 있다. 
우선 블랙리스트 탐지방법은 지명수배범을 잡는 방법과 유사하다. 보안 문제가 있는 정보를 저장하고 그 정보에 일치하는 검색 결과를 찾는 것이다. 
공격자가 감염PC를 조종하기 위해 사용하는 C2(Command & Control)서버의 도메인 또는 IP 주소, 공격자가 배포하는 악성코드의 해시값 들을 사용해서 탐지하는 방법이 대표적인 예라고 할 수 있다. 
손쉽게 적용이 가능하고 탐지역시 쉽다는 장점이 존재하지만 블랙리스트 정보를 지속적으로 최신상태로 유지를 해야 그 효과를 입증할 수 있다. 
탐지패턴을 업데이트 하지 않은 백신이 무용지물이라는 것과 동일한 경우이다. 공격자의 우회가 쉽다는 것도 단점이 될 수 있다.
화이트 리스트 탐지방법은 보안 담당자가 지정한 것 외에는 모두 무시하고 탐지하는 방법이다. 이 정책을 사용하려면 정책 입안자는 보호대상에 대한 대단히 높은 이해도를 가져야 한다. 
명백히 허용하는 것외에는 모두 보안 위협으로 간주하므로 이 방식은 알려지거나 알려지지 않은 위협 모두 대응이 가능하다. 즉, 보호대상을 명확히 이해하면 어떤 공격이 오는 지에 대해 모두 알 필요가 없다는 점이다. 
보호 대상에 대한 이해도가 높기 때문에 보안 문제 탐지는 매우 정확하다. 다만 항상 최신 정상 상태를 유지하기에 많은 비용과 노력이 든다는 단점이 있으며, 모든 데이터에 이 방식을 적용할 수는 없다. 
웹 서비스를 제공하는 기업이 프로그램 자체의 취약점이 아니라, 개발과정의 처리 절차의 문제점이 발생한다면 이 방식으로 보안 이상 탐지를 기대하기는 어렵다.
이상 징후 탐지방법은 화이트리스트 탐지방법과 유사한 기법이라고 볼 수 있다.  이상징후는 정상 행위를 정의하고 이 정상행위를 벗어나는 모든 행위를 탐지하는 것이다. 
그러므로 이 기법을 적용하려면 반드시 정상이 무엇인지 먼저 알고 있어야 한다. 그래야만 정상의 범위에 속하지 않는 것들을 비정상으로 분류할 수 있다.  
장점으로는 알려지지 않은 위협을 탐지할 수 있고, 사용자들의 환경설정 오류 등도 탐지할 수 있다. 
예를 들면 잘못된 방화벽 정책 적용으로 접속 포트가 개방되는 경우도 이상 징후로 판별이 가능하다. 
단점으로는 정상을 정의하기가 생각보다 어렵다는 점이다. 또한 정상을 정의해도 수동 분석을 활용한 예외처리가 반드시 수반되어야 한다. 
너무 엄격하게 정상을 정의하면 정상 서비스 제공에 영향을 줄 수도 있으며, 서비스를 해치면서 보안이 적용될 수는 없다.