Splunk App을 알아보기 이전에 SIEM에 대해서 먼저 살펴보자. 

SIEM(Security Information & Evemtn Management)는 과연 무엇을 의미하는가? 우선 가장 범용적인 정의 두 가지를 살펴보자. 


In the field of computer security, security information and event management (SIEM) software products and services combine security information management (SIM) and security event management (SEM). 
They provide real-time analysis of security alerts generated by applications and network hardware.
(출처: https://en.wikipedia.org/wiki/Security_information_and_event_management)

SIEM (Security Information and Event Management) software centrally collects, stores, and analyzes logs from perimeter to end user. 
It monitors for security threats in real time for quick attack detection, containment, and response with holistic security reporting and compliance management.
(출처:https://www.juniper.net/us/en/products-services/what-is/siem/)

위키의 정의는 분석에 초점을 둔 정의이다. 반면 Juniper에서 제공하는 정의는 네트워크 전계층의 로그를 수집하고 분석하는 것을 더 얘기한다.  하지만 두 정의에 모두 실시간(real-time)으로 수집과 분석을 제공하는 것이 명시되어 있다.
이를 보면 다양한 보안 위협을 하나로 수집하고 이를 매우 빠르게 분석해서 보안위협을 무력화시키는 것이 SIEM의 가장 큰 목표라고 할 수 있다. 

Real-time의 개념은 상대적이다. 전투기가 처리해야 하는 real-time과 기말고사를 치르는 학생들의 real-time이 다를 수 밖에 없기 때문이다. 보안에서 real-time은 어느정도 일까? 
일반적으로 real-time은 발생하자마자 즉시 탐지하고 대응해야 하는 것으로 생각하지만 나는 그렇게까지 할 필요는 없다고 본다. 물론 보안 위협이 발생하자 마자 바로 탐지해서 그 싹을 제거한다면 대응은 대단히 효과적이다. 
하지만 우리가 보안 위협을 모두 탐지할 수 있을까? 그리고 탐지한 보안 위협이 모두 정확한 탐지일까? 탐지는 결코 쉽지 않은 분야이다. 그리고 정보보안은 탐지가 가장 어려운 분야이기도 하다. 
그래서 필자는 정보보안에서 real-time은 실제로 피해가 발생하기 이전에만 탐지가 동작하면 된다고 생각한다. Rockheed Martin에서 발표한 Cyber-Kill Chain을 보면 공격자가 목표를 공격하는 단계를 구분해놓았다.

https://www.lockheedmartin.com/en-us/capabilities/cyber/cyber-kill-chain.html

이 7단계에서 공격자는 공격목표를 설정하고 공격에 필요한 부가적인 행위를 수행한 이후에 실제로 데이터를 외부로 유출한다. 이 7단계엇 탐지는 어느 단계에서 동작할 때 가장 효과적일까? 1단계부터 탐지하고 차단하면 정말 좋겠지만 현실은 그렇지 못한다.
방어자인 보안 담당자는 최악의 경우인 7단계 외부 유출 이전에만 차단하면 공격 성공을 실패로 바꿀 수 있다. 즉, 방어자는 6번의 방어기회가 있어서 어느 단계에서든 성공하면 된다. 하지만 공격자는 7단계 모두 성공해야 한다.
6분의 1만 성공하면 방어 목적을 달성하는 방어자와 7번의 단계를 모두 완벽하게 수행해야하는 공격자는 누가 우위에 있을까? 통계적으로 보면 공격자의 공격 성공률이 방어자보다 더 작다. 그러므로 방어자가 우위에 있다고 볼 수 있다. 
하지만 우리는 공격이 성공한 사례만을 접하기 때문에 공격자가 훨씬 높은 성공률을 가지고 있는 것처럼 보인다. 하지만 실제로는 그렇지 않다는 것을 알아야 한다. 하지만 공격자가 공격을 성공한 사이트가 내가 관리하는 곳이라면 이 모든 통계는 의미없게 된다. 

Cyber Kill chain은 공격자의 공격을 보여주는 한 예이다. 모든 공격이 이와 동일한 단계를 거치지는 않는다. 하지만 공격자의 단계별 행동을 이해하기에는 가장 좋은 예라고 할 수 있다.

SIEM 분석대상 데이터 수집

SIEM을 운영하려면 우선 데이터를 모아야 한다. 그렇다면 분석 대상인 데이터는 어떻게 수집해야 하는가? 
가장 기본적으로 데이터를 보유하는 것에 대한 준수사항이 존재하는지 확인해야 한다. 일반적으로 컴플라이언스를 준수한다는 용어를 많이 사용한다. 
운영하는 전산 시스템이 컴플라이언스에 해당된다면 그에 맞추어 로그를 수집하고 보관해야 한다. 

[[주요 컴플라이언스별 데이터 보유 기간]]
PCI-DSS : 1년
ISMS(Information Security Management System) : 6개월
PIMS(Personal Information Management System)) : 6개월

보유기간은 최소를 의미한다. 그러므로 각 보유기간보다 더 길게 보관해도 전혀 문제가 되지 않는다. 각 컴플라이언스는 보유기간을 정하는 것에 추가로 수집 범위도 제시하기 때문에 이를 적용하여 수집할 수 있다. 
개별 컴플라이언스에 특별히 적용받지 않는다면 다음과 같은 수집 방법을 고려할 수 있다. 

입력기반 수집 : 발생하는 모든 데이터를 수집한다.
출력기반 수집 : 오직 분석에 필요한 데이터만을 수집한다. 
하이브리드 수집 : 발생하는 모든 데이터를 수집하지만 당장 분석하지 않는 데이터는 자동으로 제거한다.


입력기반 수집의 장점으로는 발생하는 모든 데이터를 수집하므로 다양한 관점의 분석이 가능하다는 점이다. 
하지만 모든 데이터가 수집되므로 양이 방대해서 원하는 내용을 쉽게 찾기가 어렵다는 단점이 있다. 또한 데이터의 방대한 양은 검색 응답이 느릴 수 있으며 운영에 많은 비용이 필요하다.

출력기반 수집은 보안 담당자가 인지하는 사안에 집중할 수 있는 점과 입력기반에 비해서 상대적으로 비용이 저렴하다는 장점이 있다. 그리고 입력기반 수집보다 상대적으로 데이터가 적으므로 검색 성능을 향상 시킬 수 있다. 
단점으로는 담당자기 인지하지 못하면 데이터 수집 자체가 불가능하다. 즉, 데이터 미수집은 미탐지 영역으로 남을 수 있다. 어떤 데이터를 분석할 것인지가 큰 고민으로 다가올 것이다.

하이브리드
당장 분석 대상이 아니라도 데이터를 보관해서 향후 분석이 가능하다.
지속적인 관리와 유지보수가 필요해서 비용이 발생한다.

늘 그렇듯이 정답은 사이트를 관리하는 담당자가 가지고 있어야 한다. 즉, 각자의 사이트에 맞게 데이터 수집 전략을 수립해야 한다.
 
