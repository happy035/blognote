수집 범위, 대상
안타깝게도 수집 데이터를 선택하는 것에 명확한 정답은 존재하지 않는다.
기업마다 운영하는 보안 장비가 다르고, 보안 목적이 다르기 때문이다. 그렇다고 하더라도 앞서 말했듯이 컴플라이언스는 가장 우선적으로 고려해야 한다.  컴플라이언스는 데이터 보유기관과 수집 범위를 제시하기 때문이다.
수집 범위에 대한 표준은 정해진 것이 없지만 아래 목록을 참고할 수 있다. 

● 운영체제 : 윈도우, 리눅스, 유닉스, 임베디드 장비, IoT 디바이스
● 네트워크 장비 : 라우터, L4, L3, L2 스위치
● 네트워크 보안 장비 : 방화벽, 침입차단시스템, VPN
● 호스트 보안 장비: 백신 프로그램, 데이터 유출 방지
● 응용 프로그램 : 웹서버, 웹 프록시, 데이터베이스
● 취약점 스캐너 : 네트워크 스캐너, 호스트 스캐너, 웹 스캐너
● 무결성 점검 : 파일 무결성, 소스코드 무결성 점검


데이터 용량 산정 방식
데이터 용량을 산정하는 방식은 EPS(Event per Second)를 가장 많이 사용한다. 용어에서 알 수 있듯이 초당 얼마나 많은 이벤트가 생성되는지 계산한다. 
이벤트는 데이터의 개별 단위로서 보통 새로운 줄 구분자로 구별된다. 각각의 이벤트가 분석대상이 될 수 있다. SIEM을 운영하는 서버와 수집 분석하는 소프트웨어는 해당 EPS에 대응할 수 있어야 한다. 
만일 서버가 수집 가능한 EPS에 비해 적은 수집 능력을 보유하고 있다면 서버를 증설해야 한다. 소프트웨어 역시 분석능력이 부족한 경우 노드를 추가하거나 증가시켜 실시간 분석 능력을 확보해야 한다.
EPS 계산은 아래와 같이 계산할 수 있다. 하루에 생산되는 로그의 총량은 EPD(Event per Day)이다. 

1,000,000(EPD) / 86,400 = 11,574(EPS)

하루 24시간을 초로 환산하면 86,400초를 얻을 수 있다. 그러므로 하루에 발생하는 데이터의 총량을 86,400으로 나누면 초당 생성 데이터를 얻을 수 있다. 
이 수치는 데이터 생성량의 가장 기본적인 단위가 된다. 하지만 실제로는 이렇게 간단한 계산식으로 올바른 데이터 생성량을 얻을 수 없다. 
우선 모든 시스템에서 생성되는 데이터는 매시간이 일정하게 생성되지 않기 때문이다. 즉, 24시간을 계산한다고 해도 데이터가 집중적으로 생성되는 시간이 있고 적게 생성되는 시간이 존재한다. 
이런 이유는 사용자들의 네트워크 사용 패턴이 다르기 때문이다. 
기업 내부 사용자의 네트워크는 업무가 시작되기 전인 오전 8시 30분 부터 네트워크 사용량이 증가하기 시작해서 업무가 종료되는 6시 이후를 기점으로 급격히 사용량이 줄어들게 된다. 
이러한 원리를 적용하면 기업에서 직원들이 사용하는 업무 네트워크의 경우 밤 9시부터 다음 날 아침 7시까지는 사용량이 극히 미미하다고 볼 수 있다. 
그러므로 아침 9시부터 오후 6시까지 생성되는 데이터의 양이 전체 생산량의 대부분을 차지할 수 있기 때문에 해당 시간 동안 생성된 데이터의 양을 환산한 계산방법을 적용해야 할 것이다.
또한 최대 사용량을 고려해야 한다. 보통 피크(Peak)값이라고 명명한다. 피크값은 장시간에 발생하지 않고 급격한 사용을 보이며 최대치를 나타내는 것이다. 
문제는 피크값에 고려해서 시스템을 구성해야 한다는 것이다. 이런 현상을 보면 피크값과 가장 적은 사용량의 차이가 적은 시스템이 용량 산정을 쉽게 할 수 있다. 
두 값의 차이가 크다면 피크값에 맞춰서 구축한 시스템이 많은 유휴시간을 가지기 때문에 하드웨어를 효과적으로 사용하기 어렵다. 

SIEM의 구성요소
SIEM은 하나의 단일 프로그램으로 구성되지 않는다. 데이터를 수집하고 수집한 데이터를 색인한 다음에 검색을 하는 다양한 기능을 포함하기 때문이다. 
대부분의 SIEM은 수집 부분, 색인 부분, 검색 부분으로 구성되고, 수집 개소가 많은 구성이면 데이터 수집을 원활하게 하기 위해서 중간 수집 기능이 포함되기도 한다.

위의 그림은 가장 범용적인 SIEM 구성이라고 볼 수 있다. 다음 글에서는 상세 구성방안, 검색 등을 살펴보자. 