대시보드(Dashboard)

대시보드란 Splunk가 제공하는 시각화 기능을 사용해서 사용자에게 직관적인 정보를 제공하는 페이지를 만드는 것이다. 
데이터 검색 결과와 표현할 시각화를 결합하여 만들 수 있다.  
대시보드를 만들려면 시각화를 선택해야 한다. Splunk는 다양한 시각화를 제공한다. 

Splunk는 다음과 같은 시각화 기법을 제공한다. 

이벤트 리스트
검색 결과를 이벤트로 반환한다. 이벤트는 원본 로그를 의미하므로 엄밀히 말해서 이 방식을 시각화라고 보기는 어렵다. 텍스트 로그를 그대로 보여주기 때문이다. 

테이블 
테이블은 이벤트에서 원하는 필드를 추출하여 테이블 형식으로 보여주는 방식이다. 테이블을 구성하는 셀에 색상을 입히거나 최소값, 최대값을 특정 색상으로 표시할 수 있다. 요약보고서 등을 생성할 때 사용하는 방법이다. 

차트
데이터 결과를 하나 이상의 차원으로 표시한다. 차트는 주로 X축과 Y축에 값을 표시하는 방식으로 시각화를 표현한다. 
원형, 영역형, 꺽은선형, 세로막대형, 가로막대형 등 가장 많은 시각화를 제공한다. 

단일 값
단일 값 시각화는 집계값을 강조해서 보여줄 때 사용한다. 
전체 총합, 방문자 수와 같은 단일값으로 표시하여 사용자에게 강력한 정보를 제공할 수 있다. 특정 필드의 변동 또는 추세를 보여줄 수도 있다. 숫자 범위에 따라 색상을 추가하여 가독성을 높일 수 있다.

지도
위도, 경도 정보를 활용하여 지도에 검색결과 데이터를 표시할 수 있다. 
위치정보는 Splunk에서 제공하는 기본 정보를 활용할 수도 있다. 위치정보는 생각보다 자주 변경된다. 주기적으로 Splunk가 사용하는 위치정보 데이터베이스를 갱신해야 한다.  다음에 설명하는 방법으로 지도 데이터를 업데이트할 수 있다. 

GeoLite2 데이터 업데이트 하기

Splunk는 위치정보 검색용 GeoLite2-City.mmdb 파일을 기본으로 제공한다. 이 파일은 $SPLUNK_HOME/share 디렉토리에 위치한다. 상용버전 또는 매달 업데이트되는 무료 버전 파일로 Splunk가 제공하는 파일을 대체할 수 있다.다음 절차를 따른다. 

1. http://dev.maxmind.com/geoip/geoip2/geolite2/에 접속한다. 
2. binary gzipped version의 GeoLite2 City database 파일을 다운로드 한다.
3. $SPLUNK_HOME/share 디렉토리에 파일 복사 후 압축을 해제한다. 

이제 Splunk는 자동으로 업데이트 된 파일을 참조하여 최신 지도 정보를 적용한다. 하지만 한 가지 더 수정해야 하는 항목이 존재한다. Splunk는 운영 파일에 대한 무결성 검사를 자동으로 실행하는 기능이 있다. 
위와 같은 방식으로 위치정보 파일을 업데이트하면 Splunk는 무결성이 손상되었다는 로그를 발생시킨다. 정상적인 업데이트이므로 경고를 무시하고 새로 복사한 파일의 해시값을 검사 파일에 업데이트해서 경고 발생을 차단할 수 있다. 
 Splunk를 구성하는 파일들의 무결성 값을 보관한 파일은 $SPLUNK_HOME/splunk-versionnumber-ID-platform-manifest이다. 

<code>
jinseo$ grep mmdb splunk-7.1.0-2e75b3406c5b-darwin-64-manifest
f 444 splunk splunk splunk/share/GeoLite2-City.mmdb 588efeabb66c7839d53a0006c2c7353abc852d64136e5337498287cac299be9d
</code>

f : 파일을 의미한다. d는 디렉토리이다. 
444 : 파일의 접근 권한이다. 8비트 형식의 소유권한으로 표시한다. 
splunk/share/splunk/share/GeoLite2-City.mmdb : 파일 이름과 파일 위치이다. 
588efeabb66c7839d53a0006c2c7353abc852d64136e5337498287cac299be9d : 파일에 대한 해시값이다. 사용하는 해시값은 SHA256이다. 

최신 파일로 업데이트 했다면 리눅스나 맥에서는 다음과 같은 명령어로 SHA256값을 얻을 수 있다. 
shasum –a 256 GeoLite2-city.mmdb
명령어의 결과인 해시값이 나오면 값을 복사해서 마지막 필드를 업데이트하면 Splunk는 결고를 발생시키지 않는다. 
Splunk를 최신 버전으로 판올림을 하면 이전 버전의 manifest 파일은 디렉토리에 그대로 남아있다. 
하지만 사용되지는 않는다.

