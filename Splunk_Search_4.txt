4 - 시간 연산자 (2)

검색 범위로 시간을 지정하는 방법 첫 번째인 사용자 화면을 이용한 설정을 살펴보았다. 
이번에는 검색에서 시간 범위를 직접 설정하는 방법을 알아보자. 검색에서 시간 연산자를 지정하는 방법은 다음과 같다. 
earliest=<시간 범위>  latest=<시간 범위> 
earliest는 시작시간, latest는 마지막 시간을 지정한다. 시간 범위에 now라는 키워드를 사용할 수 있으며 이는 현재 시간을 의미한다. 일반적으로 now는  latest에 사용한다. 
사실 now는 검색의 기본값이다. 즉, latest=now라는 키워드는 시간을 지정하지 않는 경우에도 Splunk는 자동으로 현재 시간까지 검색하기 때문이다. 
한 가지 알아야 하는 사항이 있다. 검색창에 earliest와 latest를 사용하여 시간을 지정했다. 
하지만 사용자 화면에 시간 설정 역시 항상 설정되어 있다. 이럴때는 어떻게 되는가?  
Splunk는 검색창에 시간 지시자가 있다면 사용자 화면의 시간 설정보다 우선하게 되어 있다.  그러므로 검색창의 시간 설정이 항상 우선한다고 생각하자. 
시간 표시는 절대시간과 상대시간으로 시간 범위를 설정할 수 있다. 

절대시간 표기
절대시간 표시 방법은 %m/%d/%Y:%H:%M:%S이다. 절대시간으로 시간 범위를 2018년 1월 31일 오후 1시부터 2018년 2월 1일 오후 1시까지를 지정하려면 다음과 같이 설정한다. 
earliest=1/31/2018:13:0:0 latest=2/1/2018:13:0:0

상대시간 표기

시간 단위를 나타내는 문자열과 정수를 결합하여 상대 시간을 정의한다. 
1. 빼기(-) 또는 더하기(+) 부호로 문자열을 시작할 수 있으며 이는 이전/이후를 의미한다. 
2. 숫자와 시간 단위를 사용하여 시간의 길이를 지정한다. 단순히 범위 만을 사용하면 기본값인 1이 포함된 것으로 간주한다. 그러므로 's'는 '1s'와 같고 'm'은 '1m'과 같다. 
사용할 수 있는 시간 단위는 다음과 같다.
시간단위
사용 키워드
초 :  s, sec, secs, second, seconds
분 :  m, min, minute, minutes
시간 :  h, hr, hrs, hour, hours
일 :  d, day, days
주 :  w, week, weeks
개월 :  mon, month, months
분기 :  q, qtr, qtrs, quarter, quarters
년 :  y, yr, yrs, year, years

시간에 맞추는 상대 시간 한정자
상대 시간을 사용하는 경우 상대 시간과의 차이를 이용해서 검색시간을 지정할 수 있다. 
맞추기 시간 단위는 사용자가 지정하는 시간 길이에 가장 가까운 시간이나 시간 길이의 종료 시간으로 반내림한다. 
복잡한 내용이지만 "@" 문자로 시간을 지정한다는 것으로 알면 쉽게 이해할 수 있다. 

간 단위에 대한 구문은 [+|-]<정수><시간단위>@<시간단위>이다. ‘-’는 이전 시간을 ‘+’는 이후 시간을 의미한다. 
시간 단위만 사용하여 상대 시간 한정자를 정의하는 방법을 살펴보자. 4시간 이전부터 로그를 검색하려면 다음과 같이 지정한다. 
현재 시간이 오후 4시 30분이면 오후 12시 30분부터 검색 범위에 포함된다. 하지만 @문자를 사용하면 검색이 다르게 실행된다. 
earliest=-4h@ latest=now

@이 없는 경우 12시 30분부터 시작하지만 @을 넣게 되면 시간에 대한 반내림을 하므로 12시 30분이 아니라 오후 12시부터 검색 범위에 포함된다. 
이 방식은 일간, 주간, 월간 검색에 편리한 표기를 제공한다. 예를 들어 이전 달의 이벤트를 검색하려면 아래와 같이 적을 수 있다.
earliest=-mon@mon latest=@mon

같은 방식으로 이전 주, 직전 일의 이벤트를 검색하려면 아래와 같다. 
earliest=-w@w latest=@w, earliest=-d@d latest=@d
